<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Nail Size Measure</title>
  <style>
    body { font-family: sans-serif; }
    #preview {
      max-width: 100%;
      display: block;
      margin-bottom: 20px;
      position: relative;
    }
    #line {
      position: absolute;
      height: 3px;
      background: red;
      cursor: ew-resize;
    }
    #container {
      position: relative;
      display: inline-block;
    }
  </style>
</head>
<body>

<h2>爪の横幅を計測</h2>

<input type="file" id="upload" accept="image/*"><br><br>

<div id="container">
  <img id="preview">
  <div id="line"></div>
</div>

<p>線の長さ（px）: <span id="pxValue">0</span> px</p>
<p>実寸（mm換算）: <span id="mmValue">0</span> mm</p>

<script>
  const upload = document.getElementById("upload");
  const preview = document.getElementById("preview");
  const line = document.getElementById("line");
  const pxValue = document.getElementById("pxValue");
  const mmValue = document.getElementById("mmValue");

  let dragging = false;

  upload.onchange = function(e) {
    const file = e.target.files[0];
    preview.src = URL.createObjectURL(file);

    line.style.width = "100px"; // 初期長さ
    line.style.top = "50%";
    line.style.left = "20px";
  };

  line.addEventListener("mousedown", () => dragging = true);
  document.addEventListener("mouseup", () => dragging = false);

  document.addEventListener("mousemove", (e) => {
    if (!dragging) return;

    const containerBox = preview.getBoundingClientRect();
    let newWidth = e.clientX - containerBox.left - parseInt(line.style.left);
    if (newWidth < 10) newWidth = 10;
    line.style.width = newWidth + "px";

    pxValue.textContent = Math.round(newWidth);
    mmValue.textContent = (newWidth * 0.264).toFixed(1); // 簡易換算
  });
</script>

</body>
</html></div>

<script src="measure.js"></script>
</body>
</html>

